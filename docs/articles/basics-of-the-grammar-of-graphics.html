<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basics of the Grammar of Graphics • analyzr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basics of the Grammar of Graphics">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">analyzr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/analysis-an-inference-example.html">Analysis: an inference example</a>
    </li>
    <li>
      <a href="../articles/basics-of-the-grammar-of-graphics.html">Basics of the Grammar of Graphics</a>
    </li>
    <li>
      <a href="../articles/data-the-tidy-and-the-untidy.html">Data: The Tidy and the Untidy</a>
    </li>
    <li>
      <a href="../articles/first-steps-in-wrangling-data.html">First Steps in Wrangling Data</a>
    </li>
    <li>
      <a href="../articles/getting-data-in-and-out-of-r.html">Getting data in and out of R</a>
    </li>
    <li>
      <a href="../articles/short_note_on_literate_programming.html">A Short Note on Literate Programming</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/WFU-TLC/analyzr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Basics of the Grammar of Graphics</h1>
                        <h4 class="author">Jerid Francom</h4>
            
            <h4 class="date">2019-02-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/WFU-TLC/analyzr/blob/master/vignettes/basics-of-the-grammar-of-graphics.Rmd"><code>vignettes/basics-of-the-grammar-of-graphics.Rmd</code></a></small>
      <div class="hidden name"><code>basics-of-the-grammar-of-graphics.Rmd</code></div>

    </div>

    
    
<div id="the-grammar-of-graphics" class="section level1">
<h1 class="hasAnchor">
<a href="#the-grammar-of-graphics" class="anchor"></a>The Grammar of Graphics</h1>
<p>The Grammar of Graphics is built on three components -data, mappings, and geometries. The <code>ggplot2</code> package incorporates this approach explicitly in creating graphics.</p>
<p>First we’ll load the packages we will need first.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; ── Attaching packages ───────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; ✔ ggplot2 3.1.0     ✔ purrr   0.3.0</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt; ✔ tibble  2.0.1     ✔ dplyr   0.7.8</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt; ✔ tidyr   0.8.2     ✔ stringr 1.3.1</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; ✔ readr   1.3.1     ✔ forcats 0.3.0</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; Warning: package 'tibble' was built under R version 3.5.2</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; Warning: package 'purrr' was built under R version 3.5.2</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; ── Conflicts ──────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></a></code></pre></div>
<p>Let’s take a built-in dataset, <code>diamonds</code>, and get an understanding what the data look like.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">glimpse</span>(diamonds)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#&gt; Observations: 53,940</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; Variables: 10</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; $ carat   &lt;dbl&gt; 0.23, 0.21, 0.23, 0.29, 0.31, 0.24, 0.24, 0.26, 0.22, 0.…</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; $ cut     &lt;ord&gt; Ideal, Premium, Good, Premium, Good, Very Good, Very Goo…</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; $ color   &lt;ord&gt; E, E, E, I, J, J, I, H, E, H, J, J, F, J, E, E, I, J, J,…</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; $ clarity &lt;ord&gt; SI2, SI1, VS1, VS2, SI2, VVS2, VVS1, SI1, VS2, VS1, SI1,…</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; $ depth   &lt;dbl&gt; 61.5, 59.8, 56.9, 62.4, 63.3, 62.8, 62.3, 61.9, 65.1, 59…</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; $ table   &lt;dbl&gt; 55, 61, 65, 58, 58, 57, 57, 55, 61, 61, 55, 56, 61, 54, …</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; $ price   &lt;int&gt; 326, 326, 327, 334, 335, 336, 336, 337, 337, 338, 339, 3…</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; $ x       &lt;dbl&gt; 3.95, 3.89, 4.05, 4.20, 4.34, 3.94, 3.95, 4.07, 3.87, 4.…</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; $ y       &lt;dbl&gt; 3.98, 3.84, 4.07, 4.23, 4.35, 3.96, 3.98, 4.11, 3.78, 4.…</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; $ z       &lt;dbl&gt; 2.43, 2.31, 2.31, 2.63, 2.75, 2.48, 2.47, 2.53, 2.49, 2.…</span></a></code></pre></div>
<p>We can also look at the data dictionary for this dataset using <code>?diamonds</code> in the Console. The least transparent of the variables are the <code>x</code>, <code>y</code>, and <code>z</code> which in the data dictionary clarify that they refer to the length, width, and depth in mm.</p>
<p>We also see that we have some categorical variables <code>cut</code> and <code>clarity</code> as well as some continuous variables <code>carat</code> and <code>price</code>, for example.</p>
<p>Knowing the informational value of our variables is key to creating an appropriate visualization. In the Grammar of Graphics we are going to take some data, in this case <code>diamonds</code>, then map some variables to a variable space with the <code>aes()</code> function, and then decide how to display these variables in a geometric space with the set of <code>geom_x</code> functions. Let’s see an example. First we can set up the data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamonds)</a>
<a class="sourceLine" id="cb3-2" title="2">p</a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/data-setup-1.png" width="700"></p>
<p>At this point there is data, but no mappings nor geometries to be represented. Let’s add a mapping of the <code>color</code> variable to the x-axis and plot that as a bar plot.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> color))</a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-bar-color-1.png" width="700"></p>
<p>Since this is a categorical variable, the y-axis is the count. We can augment this graphic by adding a <code>fill</code> aesthetic mapped to the <code>cut</code> variable.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">fill =</span> cut))</a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-bar-color-cut-1.png" width="700"></p>
<p>We can also add a third categorical dimension to this plot with a facet. The <code>facet_wrap()</code> function can be added to the graphic represent a new plot for each level of the categorical variable.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">fill =</span> cut)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>clarity)</a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-bar-color-cut-clarity-1.png" width="700"></p>
<p>Now let’s look at the continuous variable <code>price</code>. A histogram is a good way to visualize a single continuous variable.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> price))</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-price-1.png" width="700"></p>
<p>If we would like to see a combination of a categorical and continuous variable, a box plot is a often a good choice.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price))</a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-price-color-1.png" width="700"></p>
<p>A box plot, as you see, displays boxes for each of the grouping values in ‘color’. The boxes contain a lot of distributional information. Namely, we get a visual display of much of the information we get when we run ‘summary()’ on a continuous variable. Min and max values are marked with the vertical line, the top and bottom of the box correspond to the 1st and 3rd quantile, and the bold line is the median. Dots on the vertical line are marked as outliers. It’s a pretty powerful visualization!</p>
<p>We could also add a fill aesthetic to boxplots too, just as we did with bar plots earlier.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price, <span class="dt">fill =</span> clarity))</a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-price-color-clarity-1.png" width="700"></p>
<p>And we can add another categorical variable through faceting.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price, <span class="dt">fill =</span> clarity)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>cut)</a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-color-price-clarity-cut-1.png" width="700"></p>
<p>Another type of common visualization situation is when we want to compare to continuous variables. This is where the scatterplot comes in. Let’s compare the <code>carat</code> and the <code>price</code>. The <code>geom_point()</code> function will map points to the x and y values.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price))</a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-carat-price-1.png" width="700"></p>
<p>We can also add a trend line by adding another layer with the <code>geom_smooth()</code> function. But to do this we need to pass the same mappings to both the <code>geom_point()</code> and <code>geom_smooth()</code> geometries. We can do this redundantly for each geometry, or we can take a different approach to adding the data and aesthetic mappings than we have so far. The alternative is seen below.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">diamonds <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>()</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</span></a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-carat-price-trend-1.png" width="700"></p>
<p>To add a linear trendline, we can add a specific method to the <code>geom_smooth()</code> function.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">diamonds <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>)</a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-carat-price-lmtrend-1.png" width="700"></p>
<p>As you might imagine, we can add a <code>color</code> aesthetic to indicate those points that are of certain <code>clarity</code>. <em>Note: after a <code>%&gt;%</code> or <code>+</code> you can add a line break if you find that it helps make your code more legible.</em></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">diamonds <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price, <span class="dt">color =</span> clarity)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>)</a></code></pre></div>
<p><img src="basics-of-the-grammar-of-graphics_files/figure-html/dia-carat-price-clarity-trend-1.png" width="700"></p>
<p>That’s a quick rundown of the basics of the Grammar of Graphics and the <code>ggplot2</code> package. There is so much more <code>ggplot2</code> can do and surely more that you want to know how to do. A good place to start is the <a href="https://ggplot2.tidyverse.org">Ggplot2 package website</a>. I also recommend the <a href="http://a.co/d/4Ykzomf">“R Graphics Cookbook” by Winston Chang</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#the-grammar-of-graphics">The Grammar of Graphics</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jerid Francom.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
